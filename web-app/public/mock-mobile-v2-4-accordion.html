<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ãƒ‘ã‚¿ãƒ¼ãƒ³4: ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ - ç¾åœ°èª¿æŸ»ãƒã‚§ãƒƒã‚¯ã‚·ãƒ¼ãƒˆ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
    .accordion-content.open { max-height: 5000px; }
    .accordion-icon { transition: transform 0.3s; }
    .accordion-header.open .accordion-icon { transform: rotate(180deg); }
    .eval-btn { 
      min-width: 44px; min-height: 44px; 
      display: flex; align-items: center; justify-content: center;
      border-radius: 8px; font-weight: bold; transition: all 0.15s;
    }
    .eval-btn:active { transform: scale(0.95); }
    .eval-btn.selected { box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
    .eval-a { background: #dcfce7; color: #16a34a; border: 2px solid #16a34a; }
    .eval-a.selected { background: #16a34a; color: white; }
    .eval-b1 { background: #dbeafe; color: #2563eb; border: 2px solid #2563eb; }
    .eval-b1.selected { background: #2563eb; color: white; }
    .eval-b2 { background: #fef3c7; color: #d97706; border: 2px solid #d97706; }
    .eval-b2.selected { background: #d97706; color: white; }
    .eval-c { background: #fee2e2; color: #dc2626; border: 2px solid #dc2626; }
    .eval-c.selected { background: #dc2626; color: white; }
    .eval-na { background: #f1f5f9; color: #64748b; border: 2px solid #94a3b8; }
    .eval-na.selected { background: #64748b; color: white; }
    .toast { animation: slideUp 0.3s ease; }
    @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .progress-ring { transition: stroke-dashoffset 0.5s ease; }
  </style>
</head>
<body class="bg-slate-100 min-h-screen pb-24">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="sticky top-0 bg-white z-10 shadow-sm">
    <div class="px-4 py-2 flex items-center justify-between">
      <a href="mock-list.html" class="text-slate-400 text-sm">â† æˆ»ã‚‹</a>
      <div class="text-center">
        <div class="text-sm font-bold text-slate-800">ç¾åœ°èª¿æŸ»ãƒã‚§ãƒƒã‚¯ã‚·ãƒ¼ãƒˆ</div>
        <div id="headerProgress" class="text-xs text-emerald-600">0/101 å®Œäº†</div>
      </div>
      <div class="w-12 h-12 relative">
        <svg class="w-12 h-12 transform -rotate-90">
          <circle cx="24" cy="24" r="20" stroke="#e2e8f0" stroke-width="3" fill="none"/>
          <circle id="progressRing" cx="24" cy="24" r="20" stroke="#10b981" stroke-width="3" fill="none" 
                  stroke-dasharray="125.6" stroke-dashoffset="125.6" class="progress-ring"/>
        </svg>
        <div id="progressPercent" class="absolute inset-0 flex items-center justify-center text-xs font-bold text-emerald-600">0%</div>
      </div>
    </div>
  </header>

  <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¸ãƒ£ãƒ³ãƒ— -->
  <div class="sticky top-14 z-10 bg-slate-100 px-3 py-2">
    <div class="flex gap-2 overflow-x-auto pb-1">
      <button onclick="expandAll()" class="px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold whitespace-nowrap">ã™ã¹ã¦é–‹ã</button>
      <button onclick="collapseAll()" class="px-3 py-1.5 bg-slate-200 text-slate-700 rounded-full text-xs font-bold whitespace-nowrap">ã™ã¹ã¦é–‰ã˜ã‚‹</button>
      <button onclick="showIncomplete()" class="px-3 py-1.5 bg-amber-100 text-amber-700 rounded-full text-xs font-bold whitespace-nowrap">æœªå®Œäº†ã®ã¿</button>
    </div>
  </div>

  <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
  <div id="content" class="px-3 pb-4 space-y-2"></div>

  <!-- è©•ä¾¡ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="evalModal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-end">
    <div class="bg-white rounded-t-3xl w-full p-5 pb-8 max-h-[80vh] overflow-y-auto">
      <div class="w-12 h-1.5 bg-slate-300 rounded-full mx-auto mb-4"></div>
      <div class="flex items-center gap-2 mb-2">
        <span id="modalNum" class="bg-blue-600 text-white text-xs px-2 py-0.5 rounded font-bold"></span>
        <h3 id="modalTitle" class="font-bold text-slate-800"></h3>
      </div>
      <p id="modalDesc" class="text-sm text-slate-500 mb-4"></p>
      
      <div class="mb-4">
        <label class="text-xs text-slate-400 mb-1 block">å ´æ‰€ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰</label>
        <input type="text" id="locationMemo" placeholder="ä¾‹ï¼šåŒ—å´ã€2éšãªã©" 
               class="w-full border-2 border-slate-200 rounded-xl px-4 py-3 text-base focus:border-emerald-500 focus:outline-none">
      </div>
      
      <div class="grid grid-cols-5 gap-2 mb-4">
        <button onclick="selectEval('a')" class="eval-btn eval-a flex-col py-3" data-eval="a">
          <span class="text-lg">a</span>
          <span class="text-[8px]">è‰¯å¥½</span>
        </button>
        <button onclick="selectEval('b1')" class="eval-btn eval-b1 flex-col py-3" data-eval="b1">
          <span class="text-lg">b1</span>
          <span class="text-[8px]">è»½åº¦</span>
        </button>
        <button onclick="selectEval('b2')" class="eval-btn eval-b2 flex-col py-3" data-eval="b2">
          <span class="text-lg">b2</span>
          <span class="text-[8px]">ä¸­åº¦</span>
        </button>
        <button onclick="selectEval('c')" class="eval-btn eval-c flex-col py-3" data-eval="c">
          <span class="text-lg">c</span>
          <span class="text-[8px]">é‡åº¦</span>
        </button>
        <button onclick="selectEval('na')" class="eval-btn eval-na flex-col py-3" data-eval="na">
          <span class="text-lg">âˆ’</span>
          <span class="text-[8px]">å¯¾è±¡å¤–</span>
        </button>
      </div>
      
      <div class="flex gap-3">
        <button onclick="closeModal()" class="flex-1 border-2 border-slate-300 text-slate-600 py-3 rounded-xl font-bold">
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </button>
        <button id="addBtn" onclick="addEvaluation()" disabled class="flex-1 bg-slate-300 text-white py-3 rounded-xl font-bold">
          è¿½åŠ 
        </button>
      </div>
    </div>
  </div>

  <!-- ãƒˆãƒ¼ã‚¹ãƒˆ -->
  <div id="toast" class="hidden fixed bottom-20 left-4 right-4 bg-slate-800 text-white px-4 py-3 rounded-xl text-sm text-center toast z-50"></div>

  <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
  <div class="fixed bottom-0 left-0 right-0 p-3 bg-white border-t shadow-lg z-20">
    <button onclick="saveAndReturn()" class="w-full bg-emerald-600 text-white py-3 rounded-xl font-bold">
      ğŸ’¾ ä¿å­˜ã—ã¦å›³é¢ã«æˆ»ã‚‹
    </button>
  </div>

  <script>
    // æ¤œæŸ»ãƒ‡ãƒ¼ã‚¿ï¼ˆ101é …ç›®ï¼‰
    const inspectionData = {
      categories: [
        {
          id: 'cat1', name: 'å¤–éƒ¨â‘  æ•·åœ°åŠã³åœ°ç›¤', shortName: 'æ•·åœ°ãƒ»åœ°ç›¤', color: 'from-teal-500 to-teal-600',
          items: [
            { id: 'item1', num: 1, name: 'åœ°ç›¤', desc: 'åœ°ç›¤æ²ˆä¸‹ç­‰ã«ã‚ˆã‚‹ä¸é™¸ã€å‚¾æ–œç­‰ã®æœ‰ç„¡' },
            { id: 'item2', num: 2, name: 'æ•·åœ°', desc: 'æ•·åœ°å†…ã®æ’æ°´æ¡ã®ç ´æç­‰ã®æœ‰ç„¡' },
            { id: 'item3', num: 3, name: 'æ“å£', desc: 'æ“å£ã®åŠ£åŒ–åŠã³æå‚·ã®æœ‰ç„¡' },
            { id: 'item4', num: 4, name: 'æ°´æŠœããƒ‘ã‚¤ãƒ—', desc: 'æ“å£ã®æ°´æŠœããƒ‘ã‚¤ãƒ—ã®ç¶­æŒä¿å…¨ã®æœ‰ç„¡' },
            { id: 'item5', num: 5, name: 'é§è»Šå ´', desc: 'é§è»Šå ´å†…ã®ã²ã³å‰²ã‚Œã€é™¥æ²¡ã®æã‚Œã®æœ‰ç„¡' },
            { id: 'item6', num: 6, name: 'é§è¼ªå ´', desc: 'é§è¼ªå ´å†…ã®ã²ã³å‰²ã‚Œã€é™¥æ²¡ã®æã‚Œã®æœ‰ç„¡' },
            { id: 'item7', num: 7, name: 'å»ºç‰©ã®å‘¨å›²', desc: 'éš£æ¥å»ºç‰©ã®å€’å£Šã€æ¥è§¦ã®æã‚Œã®æœ‰ç„¡' },
          ]
        },
        {
          id: 'cat2', name: 'å¤–éƒ¨â‘¡ å„ç‚¹æ¤œå£å†…', shortName: 'ç‚¹æ¤œå£å†…', color: 'from-blue-500 to-blue-600',
          items: [
            { id: 'item8', num: 8, name: 'åºŠä¸‹ç‚¹æ¤œå£', desc: 'åŸºç¤ç«‹ã¡ä¸Šã‚ŠåŠã³åº•ç›¤ã®ã²ã³å‰²ã‚Œç­‰' },
            { id: 'item9', num: 9, name: 'ã‚¹ã‚³ãƒ¼ãƒ—èª¿æŸ»', desc: 'åºƒç¯„å›²ã«ã¾ãŸãã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item10', num: 10, name: 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆåŠ£åŒ–', desc: 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆã®è‘—ã—ã„åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item11', num: 11, name: 'ã•ã³æ±ãƒ»ç™½è¯', desc: 'ã•ã³æ±ã‚’ä¼´ã†ã²ã³å‰²ã‚Œã€æ¬ æã®æœ‰ç„¡' },
            { id: 'item12', num: 12, name: 'é‰„ç­‹éœ²å‡º', desc: 'é‰„ç­‹ã®éœ²å‡ºã®æœ‰ç„¡' },
            { id: 'item13', num: 13, name: 'è¨­å‚™é…ç®¡è²«é€šéƒ¨', desc: 'è¨­å‚™é…ç®¡ã®åŸºç¤è²«é€šéƒ¨ã®éš™é–“ã®æœ‰ç„¡' },
            { id: 'item14', num: 14, name: 'åŸºç¤åº•ç›¤æ°´æŸ“ã¿', desc: 'åŸºç¤åº•ç›¤ã«æ°´ãŸã¾ã‚Šåˆã¯æ°´æŸ“ã¿è·¡ã®æœ‰ç„¡' },
            { id: 'item15', num: 15, name: 'åœŸå°ãƒ»åºŠçµ„', desc: 'åœŸå°åŠã³åºŠçµ„ã®ã²ã³å‰²ã‚Œã€åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item16', num: 16, name: 'æœ¨éƒ¨è…æœ½', desc: 'æœ¨éƒ¨ã®è…æœ½ã€ã‚«ãƒ“ã®ä»˜ç€ã®æœ‰ç„¡' },
            { id: 'item17', num: 17, name: 'åŸºç¤å¤©ç«¯éš™é–“', desc: 'åŸºç¤å¤©ç«¯ã¨åœŸå°ã®é–“ã«è‘—ã—ã„éš™é–“ã®æœ‰ç„¡' },
            { id: 'item18', num: 18, name: 'åºŠçµ„æŸ“ã¿è·¡', desc: 'åºŠçµ„ã«æŸ“ã¿è·¡ã®æœ‰ç„¡' },
            { id: 'item19', num: 19, name: 'æ°´æ¼ã‚Œãƒ»å¤‰å½¢', desc: 'æ°´æ¼ã‚Œã€å¤‰å½¢ç­‰ã®æœ‰ç„¡' },
            { id: 'item20', num: 20, name: 'èŸ»å®³', desc: 'èŸ»å®³ã®æœ‰ç„¡' },
            { id: 'item21', num: 21, name: 'é…ç®¡é…ç·šæ¥ç¶šéƒ¨', desc: 'é…ç®¡åŠã³é…ç·šæ¥ç¶šéƒ¨ã®åŠ£åŒ–ã€è„±è½ã®æœ‰ç„¡' },
            { id: 'item22', num: 22, name: 'å¤©äº•ä¸‹åœ°æ', desc: 'å¤©äº•ä¸‹åœ°æã®ã²ã³å‰²ã‚Œã€æ¬ æç­‰ã®æœ‰ç„¡' },
            { id: 'item23', num: 23, name: 'å°å±‹çµ„åŠ£åŒ–', desc: 'å°å±‹çµ„ã®ã²ã³å‰²ã‚Œã€åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item24', num: 24, name: 'æ¨ªæ¶ææ¬ è¾¼ã¿', desc: 'æ¨ªæ¶æã®å¼•ã£å¼µã‚Šå´ã«æ¬ è¾¼ã¿ã®æœ‰ç„¡' },
            { id: 'item25', num: 25, name: 'é›¨æ¼ã‚Šè·¡ãƒ»è…æœ½', desc: 'å°å±‹çµ„ã«é›¨æ¼ã‚Šã®è·¡ã€è…æœ½ã®æœ‰ç„¡' },
            { id: 'item26', num: 26, name: 'é…ç®¡é…ç·šæ¥ç¶š', desc: 'é…ç®¡åŠã³é…ç·šã®æ¥ç¶šçŠ¶æ³' },
            { id: 'item27', num: 27, name: 'ãƒ€ã‚¯ãƒˆæ¥ç¶š', desc: 'ãƒ€ã‚¯ãƒˆã®æ¥ç¶šçŠ¶æ³' },
            { id: 'item28', num: 28, name: 'è€ç«è¢«è¦†', desc: 'è€ç«è¢«è¦†ã®ã²ã³å‰²ã‚Œã€æ¬ æç­‰ã®æœ‰ç„¡' },
            { id: 'item29', num: 29, name: 'é‰„éª¨éƒ¨ã‚µãƒ“', desc: 'é‰„éª¨éƒ¨ã®ã‚µãƒ“ã®æœ‰ç„¡' },
          ]
        },
        {
          id: 'cat3', name: 'å¤–éƒ¨â‘¢ åŸºç¤', shortName: 'åŸºç¤', color: 'from-indigo-500 to-indigo-600',
          items: [
            { id: 'item30', num: 30, name: 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆç›´ä»•ä¸Šã’', desc: 'å¹…0.5mmä»¥ä¸Šã®ã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item31', num: 31, name: 'æ¬ æ', desc: 'æ·±ã•20mmä»¥ä¸Šã®æ¬ æã®æœ‰ç„¡' },
            { id: 'item32', num: 32, name: 'ãƒ¢ãƒ«ã‚¿ãƒ«ä»•ä¸Šã’ã²ã³å‰²ã‚Œ', desc: 'ä»•ä¸Šéƒ¨åˆ†ã‚’è²«é€šã™ã‚‹ã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item33', num: 33, name: 'ãƒ¢ãƒ«ã‚¿ãƒ«æ¬ æ', desc: 'èº¯ä½“ã¾ã§é€£ç¶šã™ã‚‹æ¬ æã®æœ‰ç„¡' },
            { id: 'item34', num: 34, name: 'ä»•ä¸Šã’å‰¥é›¢', desc: 'ä»•ä¸Šéƒ¨åˆ†ã®åºƒç¯„å›²ãªå‰¥é›¢ã®æœ‰ç„¡' },
            { id: 'item35', num: 35, name: 'ãã®ä»–ä»•ä¸Šã’', desc: 'ãã®ä»–åŠ£åŒ–äº‹è±¡ã®æœ‰ç„¡' },
            { id: 'item36', num: 36, name: 'é‰„ç­‹éœ²å‡º', desc: 'é‰„ç­‹ã®éœ²å‡ºã®æœ‰ç„¡' },
            { id: 'item37', num: 37, name: 'åŸºç¤æ²ˆä¸‹', desc: 'åŸºç¤ã®æ²ˆä¸‹ç­‰ã®æœ‰ç„¡' },
            { id: 'item38', num: 38, name: 'åŸºç¤å¤©ç«¯é«˜ã•', desc: 'åŸºç¤å¤©ç«¯ã¨åœ°ç›¤é¢ã¨ã®å¹³å‡çš„é«˜ã•' },
            { id: 'item39', num: 39, name: 'è¨­å‚™é…ç®¡éš™é–“', desc: 'è¨­å‚™é…ç®¡ã®åŸºç¤è²«é€šéƒ¨ã®éš™é–“ã®æœ‰ç„¡' },
          ]
        },
        {
          id: 'cat4', name: 'å¤–éƒ¨â‘¢ å¤–å£', shortName: 'å¤–å£', color: 'from-purple-500 to-purple-600',
          items: [
            { id: 'item40', num: 40, name: 'å¤–å£ã²ã³å‰²ã‚Œ', desc: 'å¹…0.5mmä»¥ä¸Šã®ã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item41', num: 41, name: 'å¤–å£æ¬ æ', desc: 'æ·±ã•20mmä»¥ä¸Šã®æ¬ æã®æœ‰ç„¡' },
            { id: 'item42', num: 42, name: 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆåŠ£åŒ–', desc: 'ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆã®è‘—ã—ã„åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item43', num: 43, name: 'ã•ã³æ±ãƒ»ç™½è¯', desc: 'ã•ã³æ±ã‚’ä¼´ã†ã²ã³å‰²ã‚Œç­‰ã®æœ‰ç„¡' },
            { id: 'item44', num: 44, name: 'é‰„ç­‹éœ²å‡º', desc: 'é‰„ç­‹ã®éœ²å‡ºã®æœ‰ç„¡' },
            { id: 'item45', num: 45, name: 'ä¸‹åœ°æåŠ£åŒ–', desc: 'ä¸‹åœ°æã¾ã§åˆ°é”ã™ã‚‹ã²ã³å‰²ã‚Œç­‰ã®æœ‰ç„¡' },
            { id: 'item46', num: 46, name: 'ã‚¿ã‚¤ãƒ«åŠ£åŒ–', desc: 'è¤‡æ•°ã®ã‚¿ã‚¤ãƒ«ç­‰ã«ã¾ãŸãŒã£ãŸåŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item47', num: 47, name: 'é‰„ç­‹éœ²å‡º(RC)', desc: 'é‰„ç­‹ã®éœ²å‡ºã®æœ‰ç„¡(RC)' },
            { id: 'item48', num: 48, name: 'ä»•ä¸Šæã›ã‚Šä¸ŠãŒã‚Š', desc: 'ä»•ä¸Šæã®ã›ã‚Šä¸ŠãŒã‚Šã€è†¨ã‚‰ã¿ç­‰ã®æœ‰ç„¡' },
            { id: 'item49', num: 49, name: 'æ¿çŠ¶ä»•ä¸Šæå‰²ã‚Œ', desc: 'æ¿çŠ¶ä»•ä¸Šæã®å…¨å¹…ã«æ¸¡ã‚‹å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item50', num: 50, name: 'æ¿çŠ¶ä»•ä¸Šæã‹ã‘', desc: 'æ¿çŠ¶ä»•ä¸Šæã®ã‹ã‘æã˜ã®æœ‰ç„¡' },
            { id: 'item51', num: 51, name: 'é‡‘å±æ¿çŠ¶ä»•ä¸ŠæéŒ†', desc: 'é‡‘å±æ¿çŠ¶ä»•ä¸Šæã«è‘—ã—ã„éŒ†ã®æœ‰ç„¡' },
            { id: 'item52', num: 52, name: 'é‰„ç­‹éœ²å‡º(é‰„éª¨)', desc: 'é‰„ç­‹ã®éœ²å‡ºã®æœ‰ç„¡(é‰„éª¨)' },
            { id: 'item53', num: 53, name: 'ã‚·ãƒ¼ãƒªãƒ³ã‚°', desc: 'ã‚·ãƒ¼ãƒªãƒ³ã‚°æã®ç ´æ–­ã€æ¬ æã®æœ‰ç„¡' },
            { id: 'item54', num: 54, name: 'å»ºå…·å‘¨å›²éš™é–“', desc: 'å»ºå…·ã®å‘¨å›²ã«éš™é–“ã®æœ‰ç„¡' },
            { id: 'item55', num: 55, name: 'è»’è£æ°´æŸ“ã¿', desc: 'è»’è£ã®æ°´æŸ“ã¿ãƒ»ç ´æã®æœ‰ç„¡' },
            { id: 'item56', num: 56, name: 'é›¨æ¨‹ç ´æ', desc: 'é›¨æ¨‹ã®ç ´æã‚„ã‚«ãƒ“ç­‰ã®æœ‰ç„¡' },
            { id: 'item57', num: 57, name: 'è¨­å‚™é…ç®¡å¤–å£è²«é€šéƒ¨', desc: 'è¨­å‚™é…ç®¡ã®å¤–å£è²«é€šéƒ¨ã®éš™é–“ã®æœ‰ç„¡' },
          ]
        },
        {
          id: 'cat5', name: 'å¤–éƒ¨â‘¢ å»Šä¸‹ãƒ»éšæ®µç­‰', shortName: 'å»Šä¸‹ãƒ»éšæ®µ', color: 'from-pink-500 to-pink-600',
          items: [
            { id: 'item58', num: 58, name: 'æ”¯æŒéƒ¨æ', desc: 'æ”¯æŒéƒ¨æã®ãã‚‰ã¤ãã€ã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item59', num: 59, name: 'ä»•ä¸ŠçŠ¶æ³', desc: 'ä»•ä¸ŠçŠ¶æ³ãƒ»ã²ã³å‰²ã‚Œãƒ»æ¬ æã®æœ‰ç„¡' },
            { id: 'item60', num: 60, name: 'å¤©äº•ã‚·ãƒ¼ãƒªãƒ³ã‚°', desc: 'ã‚·ãƒ¼ãƒªãƒ³ã‚°ã®ç ´æ–­ã®æœ‰ç„¡' },
            { id: 'item61', num: 61, name: 'ç…§æ˜å™¨å…·', desc: 'ç…§æ˜å™¨å…·ã®ã‚«ãƒãƒ¼ç­‰ã®åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item62', num: 62, name: 'ãã‚‰ã¤ããƒ»éŒ†', desc: 'ãã‚‰ã¤ããƒ»éŒ†ã®æœ‰ç„¡' },
            { id: 'item63', num: 63, name: 'æ‰‹æ‘ºå£ã²ã³å‰²ã‚Œ', desc: 'ã²ã³å‰²ã‚Œãƒ»æ¬ æç­‰ã®æœ‰ç„¡' },
            { id: 'item64', num: 64, name: 'æ‰‹æ‘ºå£ã‚·ãƒ¼ãƒªãƒ³ã‚°', desc: 'ã‚·ãƒ¼ãƒªãƒ³ã‚°ã®ç ´æ–­ã€ç¡¬åŒ–ã®æœ‰ç„¡' },
            { id: 'item65', num: 65, name: 'æ‰‹æ‘ºç¬ æœ¨', desc: 'æ‰‹æ‘ºã€ç¬ æœ¨ã®åŠ£åŒ–ã€ã‚³ã‚±ç­‰ã®æœ‰ç„¡' },
            { id: 'item66', num: 66, name: 'ä»•ä¸Šã²ã³å‰²ã‚Œ', desc: 'ä»•ä¸ŠçŠ¶æ³ãƒ»ã²ã³å‰²ã‚Œãƒ»æ¬ æã®æœ‰ç„¡' },
            { id: 'item67', num: 67, name: 'é˜²æ°´å±¤', desc: 'é˜²æ°´å±¤ã®è‘—ã—ã„åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item68', num: 68, name: 'æ’æ°´å‹¾é…', desc: 'å±‹å¤–å»Šä¸‹ã®æ’æ°´å‹¾é…' },
            { id: 'item69', num: 69, name: 'æ’æ°´æºã‚ˆã”ã‚Œ', desc: 'æ’æ°´æºã®ã‚ˆã”ã‚Œã®æœ‰ç„¡' },
            { id: 'item70', num: 70, name: 'æ’æ°´æºå †ç©ç‰©', desc: 'æ’æ°´æºã€ç›®çš¿ã®å †ç©ç‰©ã®æœ‰ç„¡' },
            { id: 'item71', num: 71, name: 'åºŠã‚·ãƒ¼ãƒªãƒ³ã‚°', desc: 'ã‚·ãƒ¼ãƒªãƒ³ã‚°ã®ç ´æ–­ã€ç¡¬åŒ–ã®æœ‰ç„¡' },
            { id: 'item72', num: 72, name: 'å±‹å¤–éšæ®µæ”¯æŸ±åºŠ', desc: 'æ”¯æŸ±ã€åºŠã€æ‰‹æ‘ºã®åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item73', num: 73, name: 'éšæ®µè£å´', desc: 'éšæ®µè£å´ã®è¢«è¦†ãƒ»å¡—è£…ã®å‰¥é›¢ã®æœ‰ç„¡' },
            { id: 'item74', num: 74, name: 'æ¥åˆéƒ¨é‡‘ç‰©', desc: 'æ¥åˆéƒ¨é‡‘ç‰©ã®è…é£Ÿã®æœ‰ç„¡' },
          ]
        },
        {
          id: 'cat6', name: 'å¤–éƒ¨â‘£ å±‹æ ¹åŠã³å±‹ä¸Š', shortName: 'å±‹æ ¹ãƒ»å±‹ä¸Š', color: 'from-orange-500 to-orange-600',
          items: [
            { id: 'item75', num: 75, name: 'å±‹æ ¹åŠ£åŒ–', desc: 'å±‹æ ¹ã®åŠ£åŒ–åŠã³æå‚·ã®æœ‰ç„¡' },
            { id: 'item76', num: 76, name: 'å±‹æ ¹ãµãæ', desc: 'å±‹æ ¹ãµãæã®å‰²ã‚Œã€è…é£Ÿã®æœ‰ç„¡' },
            { id: 'item77', num: 77, name: 'ç·Šçµé‡‘ç‰©', desc: 'ç·Šçµé‡‘ç‰©ã€é›ªæ­¢ã‚é‡‘ç‰©ã®åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item78', num: 78, name: 'è»’æ¨‹', desc: 'è»’æ¨‹ã®ç ´æã®æœ‰ç„¡' },
            { id: 'item79', num: 79, name: 'ã‚¢ãƒ³ãƒ†ãƒŠç­‰', desc: 'ã‚¢ãƒ³ãƒ†ãƒŠç­‰ã®å‚¾ãã€ç ´æã®æœ‰ç„¡' },
            { id: 'item80', num: 80, name: 'è»’è£æ°´æŸ“ã¿', desc: 'è»’è£ã®æ°´æŸ“ã¿ã€ç ´æã®æœ‰ç„¡' },
            { id: 'item81', num: 81, name: 'å±‹ä¸Šé¢åŠ£åŒ–', desc: 'å±‹ä¸Šé¢ã®åŠ£åŒ–åŠã³æå‚·ã®æœ‰ç„¡' },
            { id: 'item82', num: 82, name: 'ã²ã³å‰²ã‚Œåã‚Š', desc: 'æ­©è¡Œä¸Šå±é™ºãªã²ã³å‰²ã‚Œã€åã‚Šã®æœ‰ç„¡' },
            { id: 'item83', num: 83, name: 'ä¼¸ç¸®ç›®åœ°æ', desc: 'ä¼¸ç¸®ç›®åœ°æã®æ¬ æã€æ¤ç‰©ç¹èŒ‚ã®æœ‰ç„¡' },
            { id: 'item84', num: 84, name: 'é˜²æ°´å±¤åŠ£åŒ–', desc: 'é˜²æ°´å±¤ã®åŠ£åŒ–ã®æœ‰ç„¡' },
            { id: 'item85', num: 85, name: 'ãƒ‘ãƒ©ãƒšãƒƒãƒˆ', desc: 'ãƒ‘ãƒ©ãƒšãƒƒãƒˆã®åŠ£åŒ–åŠã³æå‚·ã®æœ‰ç„¡' },
            { id: 'item86', num: 86, name: 'é‡‘å±ç¬ æœ¨', desc: 'é‡‘å±ç¬ æœ¨ã®åŠ£åŒ–åŠã³æå‚·ã®æœ‰ç„¡' },
            { id: 'item87', num: 87, name: 'æ‰‹æ‘ºãã‚‰ã¤ã', desc: 'æ‰‹æ‘ºã®ãã‚‰ã¤ãã€éŒ†ã®æœ‰ç„¡' },
            { id: 'item88', num: 88, name: 'ç¬ æœ¨çµåˆéƒ¨', desc: 'ç¬ æœ¨çµåˆéƒ¨ã®ç·©ã¿ã€å¤‰å½¢ã®æœ‰ç„¡' },
            { id: 'item89', num: 89, name: 'æ’æ°´æºãƒ‰ãƒ¬ãƒ¼ãƒ³', desc: 'æ’æ°´æºã®è©°ã¾ã‚Šã€ã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
            { id: 'item90', num: 90, name: 'æ°´ãŸã¾ã‚Š', desc: 'æ°´ãŸã¾ã‚Šã®æœ‰ç„¡' },
            { id: 'item91', num: 91, name: 'æ¶å°æ”¯æŒéƒ¨', desc: 'æ¶å°ãƒ»æ”¯æŒéƒ¨åˆ†ã®ã²ã³å‰²ã‚Œã®æœ‰ç„¡' },
          ]
        },
        {
          id: 'cat7', name: 'å¤–éƒ¨â‘¤ ç®¡ç†çŠ¶æ³', shortName: 'ç®¡ç†çŠ¶æ³', color: 'from-cyan-500 to-cyan-600',
          items: [
            { id: 'item92', num: 92, name: 'å†…è£…ãƒ»éƒµä¾¿å—ã‘', desc: 'éƒµä¾¿å—ã‘ã®ç¾è¦³ã€æ¸…æƒçŠ¶æ³' },
            { id: 'item93', num: 93, name: 'å…±ç”¨å»Šä¸‹ãƒ»ã”ã¿ç½®å ´', desc: 'æ¸…æƒãƒ»ç®¡ç†ã®çŠ¶æ…‹' },
            { id: 'item94', num: 94, name: 'é§è¼ªå ´ãƒ»é§è»Šå ´', desc: 'æ¸…æƒãƒ»ç®¡ç†ã®çŠ¶æ…‹' },
          ]
        },
        {
          id: 'cat8', name: 'é‰„ç­‹ãƒ»ã‚·ãƒ¥ãƒŸãƒƒãƒˆãƒãƒ³ãƒãƒ¼', shortName: 'é‰„ç­‹ãƒ»å¼·åº¦', color: 'from-slate-500 to-slate-600',
          items: [
            { id: 'item95', num: 95, name: 'é‰„ç­‹ç¢ºèª', desc: 'é‰„ç­‹ã®æœ‰ç„¡ã¨é…ç­‹ã®ãƒ”ãƒƒãƒã®ç¢ºèª' },
            { id: 'item96', num: 96, name: 'ã‚·ãƒ¥ãƒŸãƒƒãƒˆãƒãƒ³ãƒãƒ¼', desc: 'å¼·åº¦ä½ä¸‹ã«ã¤ã„ã¦ç¢ºèª' },
          ]
        },
        {
          id: 'cat9', name: 'ãã®ä»– é•æ³•æ€§é–¢ä¿‚', shortName: 'é•æ³•æ€§', color: 'from-red-500 to-red-600',
          items: [
            { id: 'item97', num: 97, name: 'æ§‹é€ è·é‡è¨ˆç®—ä¸é©åˆ', desc: 'å¢—ç¯‰ç­‰ã«ã‚ˆã‚‹æ§‹é€ è·é‡è¨ˆç®—ä¸é©åˆã®æ‡¸å¿µ' },
            { id: 'item98', num: 98, name: 'åœ°éœ‡å€’å£Šæ‡¸å¿µ', desc: 'å¢—ç¯‰ã€å¢—åºŠéƒ¨åˆ†ã«åœ°éœ‡ã«ã‚ˆã‚‹å€’å£Šç­‰ã®æ‡¸å¿µ' },
            { id: 'item99', num: 99, name: 'ç”¨é€”ä¸æ•´åˆ', desc: 'æ¤œæŸ»æ¸ˆè¨¼ã€è¬„æœ¬ã¨ä½¿ç”¨ç”¨é€”ã¨ã®ä¸æ•´åˆ' },
            { id: 'item100', num: 100, name: 'å½¢çŠ¶ä¸æ•´åˆ', desc: 'æ¤œæŸ»æ¸ˆè¨¼ã€å›³é¢ã€è¬„æœ¬ã¨ã®ä¸æ•´åˆ' },
            { id: 'item101', num: 101, name: 'å®Ÿæ¸¬å€¤ä¸æ•´åˆ', desc: 'å»ºç‰©å½¢çŠ¶ã®å®Ÿæ¸¬å€¤ã¨ã®ä¸æ•´åˆ' },
          ]
        }
      ]
    };

    let evaluations = {};
    let openCategories = new Set();
    let currentItemId = null;
    let selectedEval = null;

    function init() {
      loadFromStorage();
      renderContent();
      updateProgress();
    }

    function loadFromStorage() {
      const saved = localStorage.getItem('kennet_inspection_v2');
      if (saved) evaluations = JSON.parse(saved);
    }

    function saveToStorage() {
      localStorage.setItem('kennet_inspection_v2', JSON.stringify(evaluations));
    }

    function getCategoryProgress(cat) {
      let done = 0;
      cat.items.forEach(item => { if (evaluations[item.id]?.length > 0) done++; });
      return { done, total: cat.items.length };
    }

    function getTotalProgress() {
      let done = 0, total = 0;
      inspectionData.categories.forEach(cat => {
        const p = getCategoryProgress(cat);
        done += p.done; total += p.total;
      });
      return { done, total, percent: Math.round((done / total) * 100) };
    }

    function updateProgress() {
      const p = getTotalProgress();
      document.getElementById('headerProgress').textContent = `${p.done}/${p.total} å®Œäº†`;
      document.getElementById('progressPercent').textContent = `${p.percent}%`;
      const ring = document.getElementById('progressRing');
      ring.style.strokeDashoffset = 125.6 - (125.6 * p.percent / 100);
    }

    function renderContent() {
      const content = document.getElementById('content');
      content.innerHTML = inspectionData.categories.map(cat => {
        const p = getCategoryProgress(cat);
        const isComplete = p.done === p.total;
        const isOpen = openCategories.has(cat.id);
        
        return `
          <div class="bg-white rounded-xl shadow-sm overflow-hidden">
            <button onclick="toggleAccordion('${cat.id}')" 
                    class="accordion-header w-full bg-gradient-to-r ${cat.color} text-white px-4 py-3 flex justify-between items-center ${isOpen ? 'open' : ''}">
              <div class="flex items-center gap-2">
                ${isComplete ? '<span class="w-5 h-5 bg-white text-emerald-500 rounded-full flex items-center justify-center text-xs">âœ“</span>' : ''}
                <span class="font-bold text-sm">${cat.shortName}</span>
              </div>
              <div class="flex items-center gap-2">
                <span class="text-xs bg-white/20 px-2 py-0.5 rounded">${p.done}/${p.total}</span>
                <span class="accordion-icon text-white/80">â–¼</span>
              </div>
            </button>
            <div class="accordion-content ${isOpen ? 'open' : ''}" id="content-${cat.id}">
              <div class="divide-y divide-slate-100">
                ${cat.items.map(item => renderItem(item)).join('')}
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    function renderItem(item) {
      const evals = evaluations[item.id] || [];
      const hasEvals = evals.length > 0;
      
      return `
        <div class="p-3 ${!hasEvals ? 'bg-slate-50/50' : ''} flex justify-between items-start gap-2">
          <div class="flex-1" onclick="openModal('${item.id}')">
            <div class="flex items-center gap-2">
              <span class="w-6 h-6 rounded ${hasEvals ? 'bg-emerald-500' : 'bg-slate-300'} text-white text-xs flex items-center justify-center font-bold">${item.num}</span>
              <h4 class="font-bold text-slate-800 text-sm">${item.name}</h4>
              ${hasEvals ? `<span class="text-xs bg-emerald-100 text-emerald-700 px-1.5 py-0.5 rounded">${evals.length}</span>` : ''}
            </div>
            <p class="text-xs text-slate-500 mt-0.5 ml-8 line-clamp-1">${item.desc}</p>
            ${hasEvals ? `
              <div class="flex flex-wrap gap-1 mt-1.5 ml-8">
                ${evals.map((e, idx) => renderEvalBadge(item.id, e, idx)).join('')}
              </div>
            ` : ''}
          </div>
          <button onclick="openModal('${item.id}')" class="w-10 h-10 ${hasEvals ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-100 text-slate-400'} rounded-lg flex items-center justify-center text-xl flex-shrink-0">
            +
          </button>
        </div>
      `;
    }

    function renderEvalBadge(itemId, evalData, idx) {
      const colors = { 'a': 'bg-emerald-500', 'b1': 'bg-blue-500', 'b2': 'bg-amber-500', 'c': 'bg-red-500', 'na': 'bg-slate-400' };
      return `
        <span class="${colors[evalData.eval]} text-white text-[10px] px-1.5 py-0.5 rounded-full flex items-center gap-0.5">
          ${evalData.eval === 'na' ? 'âˆ’' : evalData.eval}${evalData.memo ? `: ${evalData.memo.substring(0,5)}` : ''}
          <button onclick="event.stopPropagation(); removeEvaluation('${itemId}', ${idx})" class="ml-0.5 opacity-70 hover:opacity-100">Ã—</button>
        </span>
      `;
    }

    function toggleAccordion(catId) {
      if (openCategories.has(catId)) {
        openCategories.delete(catId);
      } else {
        openCategories.add(catId);
      }
      const content = document.getElementById(`content-${catId}`);
      const header = content.previousElementSibling;
      content.classList.toggle('open');
      header.classList.toggle('open');
    }

    function expandAll() {
      inspectionData.categories.forEach(cat => openCategories.add(cat.id));
      renderContent();
    }

    function collapseAll() {
      openCategories.clear();
      renderContent();
    }

    function showIncomplete() {
      openCategories.clear();
      inspectionData.categories.forEach(cat => {
        const p = getCategoryProgress(cat);
        if (p.done < p.total) openCategories.add(cat.id);
      });
      renderContent();
    }

    function openModal(itemId) {
      currentItemId = itemId;
      selectedEval = null;
      
      let itemInfo = null;
      inspectionData.categories.forEach(cat => {
        cat.items.forEach(item => { if (item.id === itemId) itemInfo = item; });
      });
      
      document.getElementById('modalNum').textContent = itemInfo.num;
      document.getElementById('modalTitle').textContent = itemInfo.name;
      document.getElementById('modalDesc').textContent = itemInfo.desc;
      document.getElementById('locationMemo').value = '';
      
      document.querySelectorAll('#evalModal .eval-btn').forEach(btn => btn.classList.remove('selected'));
      document.getElementById('addBtn').disabled = true;
      document.getElementById('addBtn').className = 'flex-1 bg-slate-300 text-white py-3 rounded-xl font-bold';
      
      document.getElementById('evalModal').classList.remove('hidden');
    }

    function closeModal() {
      document.getElementById('evalModal').classList.add('hidden');
    }

    function selectEval(evalType) {
      selectedEval = evalType;
      document.querySelectorAll('#evalModal .eval-btn').forEach(btn => {
        btn.classList.remove('selected');
        if (btn.dataset.eval === evalType) btn.classList.add('selected');
      });
      document.getElementById('addBtn').disabled = false;
      document.getElementById('addBtn').className = 'flex-1 bg-emerald-600 text-white py-3 rounded-xl font-bold';
    }

    function addEvaluation() {
      if (!currentItemId || !selectedEval) return;
      const memo = document.getElementById('locationMemo').value.trim();
      if (!evaluations[currentItemId]) evaluations[currentItemId] = [];
      evaluations[currentItemId].push({ eval: selectedEval, memo, timestamp: Date.now() });
      saveToStorage();
      renderContent();
      updateProgress();
      closeModal();
      showToast('è©•ä¾¡ã‚’è¿½åŠ ã—ã¾ã—ãŸ');
    }

    function removeEvaluation(itemId, idx) {
      evaluations[itemId].splice(idx, 1);
      if (evaluations[itemId].length === 0) delete evaluations[itemId];
      saveToStorage();
      renderContent();
      updateProgress();
      showToast('å‰Šé™¤ã—ã¾ã—ãŸ');
    }

    function showToast(msg) {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.remove('hidden');
      setTimeout(() => t.classList.add('hidden'), 2000);
    }

    function saveAndReturn() {
      saveToStorage();
      showToast('ä¿å­˜ã—ã¾ã—ãŸ');
    }

    init();
  </script>
</body>
</html>

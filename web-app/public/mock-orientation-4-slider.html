<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>æ–¹ä½è¨­å®š - ãƒ‘ã‚¿ãƒ¼ãƒ³4: ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼é›†ç´„å‹</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { touch-action: manipulation; }
    
    .compass-needle {
      transition: transform 0.15s ease-out;
    }
    
    input[type="range"] {
      -webkit-appearance: none;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 28px;
      height: 28px;
      background: #059669;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    
    .control-row {
      background: linear-gradient(to right, #f8fafc, #f1f5f9);
    }
  </style>
</head>
<body class="bg-slate-100 h-screen flex flex-col">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header class="bg-white shadow-sm px-4 py-3 flex items-center justify-between flex-shrink-0">
    <button onclick="history.back()" class="text-slate-600 text-sm">â† æˆ»ã‚‹</button>
    <h1 class="font-bold text-slate-800">æ–¹ä½è¨­å®š</h1>
    <button onclick="save()" class="bg-emerald-600 text-white px-4 py-1.5 rounded-lg text-sm font-bold">ç¢ºå®š</button>
  </header>

  <!-- å›³é¢ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
  <div class="flex-1 relative bg-slate-200 overflow-hidden">
    <div class="absolute inset-2 bg-slate-300 rounded-xl flex items-center justify-center">
      <span class="text-slate-500">å›³é¢ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</span>
      
      <!-- ã‚³ãƒ³ãƒ‘ã‚¹ã‚¢ã‚¤ã‚³ãƒ³ -->
      <div id="compass" class="absolute" style="top: 15%; left: 50%; transform: translate(-50%, -50%);">
        <img src="houi.png" id="compassImg" width="70" height="70" class="compass-needle" style="transform: rotate(0deg);" alt="æ–¹ä½">
      </div>
    </div>
  </div>

  <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« -->
  <div class="bg-white rounded-t-3xl shadow-2xl flex-shrink-0 pb-6">
    <!-- è§’åº¦è¡¨ç¤º -->
    <div class="text-center py-4 border-b border-slate-100">
      <span class="text-3xl font-bold text-emerald-600" id="angleDisplay">åŒ— 0Â°</span>
    </div>

    <!-- ãƒ—ãƒªã‚»ãƒƒãƒˆ -->
    <div class="px-4 py-3 border-b border-slate-100">
      <div class="grid grid-cols-4 gap-2">
        <button onclick="setAngle(0)" class="preset py-2 rounded-lg text-xs font-bold bg-red-500 text-white">åŒ— 0Â°</button>
        <button onclick="setAngle(90)" class="preset py-2 rounded-lg text-xs font-bold bg-slate-100 text-slate-700">æ± 90Â°</button>
        <button onclick="setAngle(180)" class="preset py-2 rounded-lg text-xs font-bold bg-slate-100 text-slate-700">å— 180Â°</button>
        <button onclick="setAngle(270)" class="preset py-2 rounded-lg text-xs font-bold bg-slate-100 text-slate-700">è¥¿ 270Â°</button>
      </div>
    </div>

    <!-- ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
    <div class="px-4 py-3 space-y-4">
      <!-- è§’åº¦ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
      <div class="control-row rounded-xl p-3">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700">ğŸ”„ è§’åº¦</span>
          <span class="text-sm font-bold text-emerald-600" id="angleValue">0Â°</span>
        </div>
        <div class="flex items-center gap-2">
          <button onclick="adjustAngle(-5)" class="w-8 h-8 bg-slate-200 rounded-lg text-slate-600 font-bold">-</button>
          <input type="range" min="0" max="355" step="5" value="0" 
                 class="flex-1" id="angleSlider" oninput="setAngle(this.value)">
          <button onclick="adjustAngle(5)" class="w-8 h-8 bg-slate-200 rounded-lg text-slate-600 font-bold">+</button>
        </div>
      </div>

      <!-- æ¨ªä½ç½®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
      <div class="control-row rounded-xl p-3">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700">â†”ï¸ æ¨ªä½ç½®</span>
          <span class="text-sm font-bold text-blue-600" id="xValue">50%</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-xs text-slate-400">å·¦</span>
          <input type="range" min="10" max="90" value="50" 
                 class="flex-1" id="xSlider" oninput="setPosition('x', this.value)">
          <span class="text-xs text-slate-400">å³</span>
        </div>
      </div>

      <!-- ç¸¦ä½ç½®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
      <div class="control-row rounded-xl p-3">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700">â†•ï¸ ç¸¦ä½ç½®</span>
          <span class="text-sm font-bold text-blue-600" id="yValue">15%</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-xs text-slate-400">ä¸Š</span>
          <input type="range" min="10" max="90" value="15" 
                 class="flex-1" id="ySlider" oninput="setPosition('y', this.value)">
          <span class="text-xs text-slate-400">ä¸‹</span>
        </div>
      </div>

      <!-- ã‚µã‚¤ã‚ºã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
      <div class="control-row rounded-xl p-3">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm font-medium text-slate-700">ğŸ“ ã‚µã‚¤ã‚º</span>
          <span class="text-sm font-bold text-purple-600" id="scaleValue">100%</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-xs text-slate-400">å°</span>
          <input type="range" min="50" max="200" value="100" 
                 class="flex-1" id="scaleSlider" oninput="setScale(this.value)">
          <span class="text-xs text-slate-400">å¤§</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    let angle = 0;
    let posX = 50;
    let posY = 15;
    let scale = 100;

    function setAngle(newAngle) {
      angle = parseInt(newAngle) % 360;
      if (angle < 0) angle += 360;
      
      document.getElementById('compassImg').style.transform = `rotate(${angle}deg) scale(${scale / 100})`;
      document.getElementById('angleSlider').value = angle;
      document.getElementById('angleValue').textContent = `${angle}Â°`;
      
      const directions = { 0: 'åŒ—', 90: 'æ±', 180: 'å—', 270: 'è¥¿' };
      const dir = directions[angle] || '';
      document.getElementById('angleDisplay').textContent = dir ? `${dir} ${angle}Â°` : `${angle}Â°`;
      
      // ãƒ—ãƒªã‚»ãƒƒãƒˆæ›´æ–°
      document.querySelectorAll('.preset').forEach((btn, i) => {
        const angles = [0, 90, 180, 270];
        btn.className = angles[i] === angle 
          ? 'preset py-2 rounded-lg text-xs font-bold bg-red-500 text-white'
          : 'preset py-2 rounded-lg text-xs font-bold bg-slate-100 text-slate-700';
      });
    }

    function adjustAngle(delta) {
      let newAngle = angle + delta;
      if (newAngle < 0) newAngle += 360;
      if (newAngle >= 360) newAngle -= 360;
      setAngle(newAngle);
    }

    function setPosition(axis, value) {
      const compass = document.getElementById('compass');
      
      if (axis === 'x') {
        posX = parseInt(value);
        compass.style.left = `${posX}%`;
        document.getElementById('xValue').textContent = `${posX}%`;
      } else {
        posY = parseInt(value);
        compass.style.top = `${posY}%`;
        document.getElementById('yValue').textContent = `${posY}%`;
      }
    }

    function setScale(value) {
      scale = parseInt(value);
      document.getElementById('compassImg').style.transform = `rotate(${angle}deg) scale(${scale / 100})`;
      document.getElementById('scaleValue').textContent = `${scale}%`;
    }

    function save() {
      alert(`ä¿å­˜ã—ã¾ã—ãŸ\nè§’åº¦: ${angle}Â°\nä½ç½®: (${posX}%, ${posY}%)\nã‚µã‚¤ã‚º: ${scale}%`);
    }

    // åˆæœŸä½ç½®è¨­å®š
    setPosition('x', 50);
    setPosition('y', 15);
  </script>
</body>
</html>
